{"version":3,"sources":["../test/test.js"],"names":["SFTest","files","completion","mk","keys","SFJS","crypto","generateKeysFromMasterKey","index","processedData","readNext","file","reader","FileReader","onload","e","data","JSON","parse","target","result","console","log","SFItemTransformer","decryptItem","item","Item","length","items","bind","readAsText","window"],"mappings":";;;;;;IAAMA,M;;;;;;;iCAESC,K,EAAOC,U,EAAY;;AAE9B,UAAIC,KAAK,cAAT;AACA,UAAIC,OAAOC,KAAKC,MAAL,CAAYC,yBAAZ,CAAsCJ,EAAtC,CAAX;;AAEA,UAAIK,QAAQ,CAAZ;AACA,UAAIC,gBAAgB,EAApB;;AAEA,UAAIC,WAAW,YAAW;AACxB,YAAIC,OAAOV,MAAMO,KAAN,CAAX;AACAA;AACA,YAAII,SAAS,IAAIC,UAAJ,EAAb;;AAEAD,eAAOE,MAAP,GAAgB,UAASC,CAAT,EAAY;;AAE1B,cAAIC,OAAOC,KAAKC,KAAL,CAAWH,EAAEI,MAAF,CAASC,MAApB,CAAX;;AAEA;AACAC,kBAAQC,GAAR,CAAYN,IAAZ;;AAEAO,4BAAkBC,WAAlB,CAA8BR,IAA9B,EAAoCZ,IAApC;AACAiB,kBAAQC,GAAR,CAAY,WAAZ,EAAyBN,IAAzB;;AAEA,cAAIS,OAAO,IAAIC,IAAJ,CAASV,IAAT,CAAX;AACAK,kBAAQC,GAAR,CAAY,OAAZ,EAAqBG,IAArB;;AAEA,cAAGjB,QAAQP,MAAM0B,MAAjB,EAAyB;AACvBjB;AACD,WAFD,MAEO;AACLR,uBAAW,EAAC0B,OAAOnB,aAAR,EAAX;AACD;AACF,SAlBe,CAkBdoB,IAlBc,CAkBT,IAlBS,CAAhB;AAmBAjB,eAAOkB,UAAP,CAAkBnB,IAAlB;AACD,OAzBc,CAyBbkB,IAzBa,CAyBR,IAzBQ,CAAf;;AA2BAnB;AACD;;;;;;AAGHqB,OAAO/B,MAAP,GAAgB,IAAIA,MAAJ,EAAhB","file":"test.js","sourcesContent":["class SFTest {\n\n  decryptFiles(files, completion) {\n\n    var mk = \"<master key>\";\n    var keys = SFJS.crypto.generateKeysFromMasterKey(mk);\n\n    var index = 0;\n    var processedData = [];\n\n    var readNext = function() {\n      var file = files[index];\n      index++;\n      var reader = new FileReader();\n\n      reader.onload = function(e) {\n\n        var data = JSON.parse(e.target.result);\n\n        // decrypt data\n        console.log(data);\n\n        SFItemTransformer.decryptItem(data, keys);\n        console.log(\"Decrypted\", data);\n\n        var item = new Item(data);\n        console.log(\"Item:\", item);\n\n        if(index < files.length) {\n          readNext();\n        } else {\n          completion({items: processedData});\n        }\n      }.bind(this)\n      reader.readAsText(file);\n    }.bind(this);\n\n    readNext();\n  }\n}\n\nwindow.SFTest = new SFTest()\n"]}